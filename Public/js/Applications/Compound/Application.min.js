"use strict";Application&&(Application.Modules.Compound=new Application.Interface({requires:{vue:!0,jquery:!0},elements:{vue:["#compound__editor__frame"]},vue:{delimiters:Application.Config.VUE.Delimiters,el:"#compound__editor__frame",data:{store:{components:[],templates:[]},document:!1,style:!1,selected:[],bufferCopyPaste:[],thereCriticalError:!1},mounted:function(a=null){jQuery(".__compound_hide_before_mounted").removeClass("__compound_hide_before_mounted");const b=this;this.update().then(()=>{jQuery(".__compound_editor_document").selectable({filter:".__compound_editor_container",stop:function(){b.selected=[],jQuery(".ui-selected",this).each(function(){b.selected.push(jQuery(this).attr("data-compound-path"))})}}),jQuery("#compound_layout").sortable({axis:"xy",containment:"document",disabled:!0,tolerance:"pointer",placeholder:"__compound_placeholder",helper:"clone",opacity:.5,cursor:"move",forcePlaceholderSize:!0,revert:20,delay:0,start:(a,b)=>{b.placeholder.height(b.item.height())},stop:()=>{jQuery("#compound_layout").sortable("option","disabled",!0)},update:()=>{var a=[];jQuery("#compound_layout").find(".__compound_editor_index").each(function(){a.push(jQuery(this).attr("data-compound-path"))}),b.updateOrder(a)}}),jQuery(document).keydown(function(a){[]!=b.selected&&null!=b.selected&&b.selected&&(a.ctrlKey&&86==a.keyCode?(a.preventDefault(),b.dublicate(b.bufferCopyPaste)):a.ctrlKey&&67==a.keyCode?(a.preventDefault(),b.bufferCopyPaste=b.selected):a.ctrlKey&&46==a.keyCode&&(a.preventDefault(),b.remove(b.selected))),a.ctrlKey&&82==a.keyCode&&(a.preventDefault(),b.update())})}).catch(()=>{}),new Application.Postman({method:"CompoundPrivate/store",body:{type:"COMPONENTS"}}).then(a=>{this.store.components=a.data}).catch(()=>{}),new Application.Postman({method:"CompoundPrivate/store",body:{type:"TEMPLATES"}}).then(a=>{this.store.templates=a.data}).catch(()=>{})},methods:{__editor:function(a,b){try{return this.store.templates[a].editor[b]}catch(a){return{}}},__about:function(a){return"undefined"!=typeof this.store.components[a.component]&&"undefined"!=typeof this.store.components[a.component].about?this.store.components[a.component].about:{title:"Undefined",description:"Undefined",icon:!1}},__getMarkup:function(){return new Application.Postman({method:"CompoundPrivate/markup",body:{id:Application.Constants.WordPress.ID}})},error:function(a){this.thereCriticalError={901:{title:"Template code is broken",description:"Your template code is corrupted. Most likely because you made a mistake when manually editing the document.<br>Please revert the document to an earlier version or recreate the page"}}[a]},update:function(){this;return jQuery(".__compound_editor_area").addClass("__compound_almost_inaccessible"),this.__getMarkup().then(a=>(500==a.status&&this.error(901),a.data.document?(jQuery(".ui-selected").removeClass("ui-selected"),this.document=Object.freeze(a.data.document),this.style=Object.freeze(a.data.style),!0):this.document=!1)).catch(()=>{}).finally(()=>{jQuery(".__compound_editor_area").removeClass("__compound_almost_inaccessible")})},editComponent:function(a){const b=Application.Modules.CompoundModal.vue,c=Application.Components.Compound.EditComponent;console.log(a.target.attributes),b.mount(c),b.open({PageID:Application.Constants.WordPress.ID,Area:a.target.attributes["data-compound-area"].value,Template:a.target.attributes["data-compound-template"].value,Index:a.target.attributes["data-compound-index"].value,Component:a.target.attributes["data-compound-component"].value,Document:this.document})},insertTemplate:function(){const a=Application.Modules.CompoundModal.vue,b=Application.Components.Compound.InsertTemplate;a.mount(b),a.open({PageID:Application.Constants.WordPress.ID,templates:this.store.templates})},insertComponent:function(a){const b=Application.Modules.CompoundModal.vue,c=Application.Components.Compound.InsertComponent;b.mount(c),b.open({PageID:Application.Constants.WordPress.ID,path:a.target.attributes["data-compound-path"].value,components:this.store.components})},dublicate:function(a){new Application.Postman({method:"CompoundPrivate/template",body:{PageID:Application.Constants.WordPress.ID,type:"DUBLICATE",DUBLICATE:a||this.selected}}).then(()=>{this.update()}).catch(()=>{this.update()})},remove:function(a){new Application.Postman({method:"CompoundPrivate/template",body:{PageID:Application.Constants.WordPress.ID,type:"DELETE",DELETE:a||this.selected}}).then(()=>{this.update()}).catch(()=>{this.update()})},updateOrder:function(a){new Application.Postman({method:"CompoundPrivate/template",body:{PageID:Application.Constants.WordPress.ID,type:"ORDER",ORDER:a||[]}}).finally(()=>{this.update()})},_mouseoverTemplateTools:function(a){const b=jQuery(a.target).closest(".__compound_editor_template").find("[data-selected]");b.attr("data-selected","true"),jQuery("#compound_layout").sortable("option","disabled",!1)},_mouseleaveTemplateTools:function(a){const b=jQuery(a.target).closest(".__compound_editor_template").find("[data-selected]");b.attr("data-selected","false"),jQuery("#compound_layout").sortable("option","disabled",!0)}}},ready:function(){}}));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VyxDQUFDLE9BQWhCLENBQXdCLENBQ3BCLE1BQU0sQ0FBRSwwQkFEWSxDQUVwQixJQUFJLENBQUUsQ0FDRixNQUFNLENBQUUsV0FBVyxDQUFDLFNBQVosQ0FBc0IsU0FBdEIsQ0FBZ0MsRUFEdEMsQ0FFRixJQUFJLENBQUUsT0FGSixDQUdGLEtBQUssQ0FBRSxDQUFLLEVBQUksRUFIZCxDQUZjLENBQXhCLEVBT0csT0FQSCxDQU9XLElBQU8sQ0FDZCxLQUFLLE1BQUwsRUFDSCxDQVRELENBV0gsQ0FqTEksQ0FtTEwsdUJBQXVCLENBQUUsU0FBVSxDQUFWLENBQWtCLENBRXZDLEtBQU0sQ0FBQSxDQUFTLENBQUcsTUFBTSxDQUFDLENBQU0sQ0FBQyxNQUFSLENBQU4sQ0FBc0IsT0FBdEIsQ0FBOEIsNkJBQTlCLEVBQTZELElBQTdELENBQWtFLGlCQUFsRSxDQUFsQixDQUVBLENBQVMsQ0FBQyxJQUFWLENBQWUsZUFBZixDQUFnQyxNQUFoQyxDQUp1QyxDQUt2QyxNQUFNLENBQUMsa0JBQUQsQ0FBTixDQUEyQixRQUEzQixDQUFvQyxRQUFwQyxDQUE4QyxVQUE5QyxJQUdILENBM0xJLENBNkxMLHdCQUF3QixDQUFFLFNBQVUsQ0FBVixDQUFrQixDQUV4QyxLQUFNLENBQUEsQ0FBUyxDQUFHLE1BQU0sQ0FBQyxDQUFNLENBQUMsTUFBUixDQUFOLENBQXNCLE9BQXRCLENBQThCLDZCQUE5QixFQUE2RCxJQUE3RCxDQUFrRSxpQkFBbEUsQ0FBbEIsQ0FFQSxDQUFTLENBQUMsSUFBVixDQUFlLGVBQWYsQ0FBZ0MsT0FBaEMsQ0FKd0MsQ0FLeEMsTUFBTSxDQUFDLGtCQUFELENBQU4sQ0FBMkIsUUFBM0IsQ0FBb0MsUUFBcEMsQ0FBOEMsVUFBOUMsSUFFSCxDQXBNSSxDQS9IUixDQVJnRCxDQStVckQsS0FBSyxDQUFFLFVBQVksQ0FFbEIsQ0FqVm9ELENBQTFCLEMiLCJmaWxlIjoiQXBwbGljYXRpb24ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBXZWxjb21lIHRvIHRoZSBzb3VyY2UgY29kZVxuICpcbiAqIOKWiOKWiOKWiOKVl+KWkeKWkeKWkeKWiOKWiOKWiOKVl+KWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVl+KWkeKWkeKWkeKWkeKWkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyAgICAgICAg4paR4paR4paR4paR4paR4paI4paI4pWX4paR4paI4paI4paI4paI4paI4paI4pWXXG4gKiDilojilojilojilojilZfilpHilojilojilojilojilZHilojilojilZHilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZHilpHilpHilpHilpHilpHilojilojilZTilZDilZDilZDilZDilZ0gICAgICAgIOKWkeKWkeKWkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVnVxuICog4paI4paI4pWU4paI4paI4paI4paI4pWU4paI4paI4pWR4paI4paI4pWR4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4pWX4paR4paR4paI4paI4pWR4paR4paR4paR4paR4paR4paI4paI4paI4paI4paI4pWX4paR4paRICAgICAgICDilpHilpHilpHilpHilpHilojilojilZHilZrilojilojilojilojilojilZfilpFcbiAqIOKWiOKWiOKVkeKVmuKWiOKWiOKVlOKVneKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKVneKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkeKWkeKWkeKWiOKWiOKVlOKVkOKVkOKVneKWkeKWkSAgICAgICAg4paI4paI4pWX4paR4paR4paI4paI4pWR4paR4pWa4pWQ4pWQ4pWQ4paI4paI4pWXXG4gKiDilojilojilZHilpHilZrilZDilZ3ilpHilojilojilZHilojilojilZHilojilojilZHilpHilpHilojilojilZHilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZcgICAgICAgIOKVmuKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVnVxuICog4pWa4pWQ4pWd4paR4paR4paR4paR4paR4pWa4pWQ4pWd4pWa4pWQ4pWd4pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdICAgICAgICDilpHilZrilZDilZDilZDilZDilZ3ilpHilZrilZDilZDilZDilZDilZDilZ3ilpFcbiAqXG4gKiDilpHilojilojilojilojilojilZfilpHilojilojilojilojilojilojilZfilpHilojilojilojilZfilpHilpHilpHilojilojilojilZfilojilojilZfilojilojilojilZfilpHilpHilojilojilZfilojilojilZfilpHilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilZfilpHilpHilojilojilojilojilojilZfilpHilojilojilojilojilojilojilojilojilZfilpHilojilojilojilojilojilZfilpHilojilojilojilojilojilojilZfilpFcbiAqIOKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKWiOKWiOKVlOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KVmuKVkOKVkOKWiOKWiOKVlOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl1xuICog4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4pWR4paR4paR4paI4paI4pWR4paI4paI4pWU4paI4paI4paI4paI4pWU4paI4paI4pWR4paI4paI4pWR4paI4paI4pWU4paI4paI4pWX4paI4paI4pWR4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4pWX4paR4paR4paR4paR4paI4paI4pWR4paR4paR4paR4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4paR4paR4paI4paI4pWR4paI4paI4paI4paI4paI4paI4pWU4pWdXG4gKiDilojilojilZTilZDilZDilojilojilZHilojilojilZHilpHilpHilojilojilZHilojilojilZHilZrilojilojilZTilZ3ilojilojilZHilojilojilZHilojilojilZHilZrilojilojilojilojilZHilojilojilZHilpHilZrilZDilZDilZDilojilojilZfilpHilpHilpHilojilojilZHilpHilpHilpHilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilojilojilZHilpHilpHilpHilojilojilZHilpHilpHilpHilojilojilZHilpHilpHilojilojilZHilojilojilZTilZDilZDilojilojilZdcbiAqIOKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkeKWkeKVmuKVkOKVneKWkeKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKVkeKWkeKVmuKWiOKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkeKVmuKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkVxuICog4pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paR4pWa4pWQ4pWd4paR4paR4paR4paR4paR4pWa4pWQ4pWd4pWa4pWQ4pWd4pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWQ4pWd4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paR4paR4paR4paR4pWa4pWQ4pWd4paR4paR4paR4pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWd4pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWd4paR4paR4paR4pWa4pWQ4pWd4paR4paR4paR4paR4pWa4pWQ4pWQ4pWQ4pWQ4pWd4paR4pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWdXG4gKlxuICpcbiAqXG4gKiBAcGFja2FnZSBNaXJlbGVcbiAqIEBhdXRob3IgTWlyZWxlXG4gKiBAdmVyc2lvbiAxLjAuMFxuICpcbiAqIEBzZWUgaHR0cHM6Ly92dWVqcy5vcmcvdjIvZ3VpZGUvXG4gKi9cblxuXCJ1c2Ugc3RyaWN0XCI7XG5cbmlmIChBcHBsaWNhdGlvbikge1xuXG4gICAgQXBwbGljYXRpb24uTW9kdWxlcy5Db21wb3VuZCA9IG5ldyBBcHBsaWNhdGlvbi5JbnRlcmZhY2Uoe1xuICAgICAgICByZXF1aXJlczoge1xuICAgICAgICAgICAgdnVlOiAgICB0cnVlLFxuICAgICAgICAgICAganF1ZXJ5OiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIGVsZW1lbnRzOiB7XG4gICAgICAgICAgICB2dWU6IFsnI2NvbXBvdW5kX19lZGl0b3JfX2ZyYW1lJ11cbiAgICAgICAgfSxcbiAgICAgICAgdnVlOiB7XG4gICAgICAgICAgICBkZWxpbWl0ZXJzOiBBcHBsaWNhdGlvbi5Db25maWcuVlVFLkRlbGltaXRlcnMsXG4gICAgICAgICAgICBlbDogJyNjb21wb3VuZF9fZWRpdG9yX19mcmFtZScsXG4gICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgc3RvcmU6IHtcbiAgICAgICAgICAgICAgICAgICAgY29tcG9uZW50czogW10sXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlczogW11cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGRvY3VtZW50OiBmYWxzZSxcbiAgICAgICAgICAgICAgICBzdHlsZTogZmFsc2UsXG4gICAgICAgICAgICAgICAgc2VsZWN0ZWQ6IFtdLFxuICAgICAgICAgICAgICAgIGJ1ZmZlckNvcHlQYXN0ZTogW10sXG4gICAgICAgICAgICAgICAgdGhlcmVDcml0aWNhbEVycm9yOiBmYWxzZVxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgbW91bnRlZDogZnVuY3Rpb24gKGU9bnVsbCkge1xuXG4gICAgICAgICAgICAgICAgalF1ZXJ5KCcuX19jb21wb3VuZF9oaWRlX2JlZm9yZV9tb3VudGVkJykucmVtb3ZlQ2xhc3MoJ19fY29tcG91bmRfaGlkZV9iZWZvcmVfbW91bnRlZCcpO1xuXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgdGhpcy51cGRhdGUoKS50aGVuKGV2ZW50ID0+IHtcblxuICAgICAgICAgICAgICAgICAgICBqUXVlcnkoXCIuX19jb21wb3VuZF9lZGl0b3JfZG9jdW1lbnRcIikuc2VsZWN0YWJsZSh7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWx0ZXI6ICcuX19jb21wb3VuZF9lZGl0b3JfY29udGFpbmVyJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNhbmNlbDogJ1tkYXRhLWNvbXBvbmVudD1cInRlbXBsYXRlLWNvbnRyb2xcIl0sW2RhdGEtY29tcG9uZW50PVwiZmllbGQtY29tcG9uZW50XCJdJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbGVjdGVkOiBmdW5jdGlvbiAoZXZlbnQsIHVpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5zZWxlY3RlZCA9IGNvbnRleHQuZ2V0U2VsZWN0ZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZWxlY3Rpbmc6IGZ1bmN0aW9uIChldmVudCwgdWkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLnNlbGVjdGVkID0gY29udGV4dC5nZXRTZWxlY3RlZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVuc2VsZWN0ZWQ6IGZ1bmN0aW9uIChldmVudCwgdWkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vICAgICB0aGlzLnNlbGVjdGVkID0gY29udGV4dC5nZXRTZWxlY3RlZCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHVuc2VsZWN0aW5nOiBmdW5jdGlvbiAoZXZlbnQsIHVpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy5zZWxlY3RlZCA9IGNvbnRleHQuZ2V0U2VsZWN0ZWQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBzdG9wOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZCA9IFtdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpRdWVyeShcIi51aS1zZWxlY3RlZFwiLCB0aGlzICkuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZC5wdXNoKGpRdWVyeSh0aGlzKS5hdHRyKCdkYXRhLWNvbXBvdW5kLXBhdGgnKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGpRdWVyeShcIiNjb21wb3VuZF9sYXlvdXRcIikuc29ydGFibGUoe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBheGlzOiBcInh5XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250YWlubWVudDogXCJkb2N1bWVudFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB0b2xlcmFuY2U6IFwicG9pbnRlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6IFwiX19jb21wb3VuZF9wbGFjZWhvbGRlclwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY29ubmVjdFdpdGg6IGpRdWVyeSgnW2RhdGEtYmVoYXZpb3I9XCJkcm9wcGFibGVcIl1bZGF0YS1uYW1lc3BhY2U9XCJlZGl0b3JcIl0nKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlbHBlcjogJ2Nsb25lJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAuNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnNvcjogXCJtb3ZlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3JjZVBsYWNlaG9sZGVyU2l6ZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldmVydDogMjAsXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxheTogMCxcblxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQ6IChldmVudCwgdWkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1aS5wbGFjZWhvbGRlci5oZWlnaHQodWkuaXRlbS5oZWlnaHQoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgc3RvcDogKGV2ZW50LCB1aSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGpRdWVyeShcIiNjb21wb3VuZF9sYXlvdXRcIikuc29ydGFibGUoXCJvcHRpb25cIiwgXCJkaXNhYmxlZFwiLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGU6IChldmVudCwgdWkpID0+IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcmRlciA9IFtdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgalF1ZXJ5KFwiI2NvbXBvdW5kX2xheW91dFwiKS5maW5kKCcuX19jb21wb3VuZF9lZGl0b3JfaW5kZXgnKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIucHVzaChqUXVlcnkodGhpcykuYXR0cignZGF0YS1jb21wb3VuZC1wYXRoJykpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi51cGRhdGVPcmRlcihvcmRlcik7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgalF1ZXJ5KGRvY3VtZW50KS5rZXlkb3duKGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGYuc2VsZWN0ZWQgIT0gW10gJiYgc2VsZi5zZWxlY3RlZCAhPSBudWxsICYmIHNlbGYuc2VsZWN0ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihlLmN0cmxLZXkgJiYgZS5rZXlDb2RlID09IDg2KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmR1YmxpY2F0ZShzZWxmLmJ1ZmZlckNvcHlQYXN0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChlLmN0cmxLZXkgJiYgZS5rZXlDb2RlID09IDY3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5idWZmZXJDb3B5UGFzdGUgPSBzZWxmLnNlbGVjdGVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZS5jdHJsS2V5ICYmIGUua2V5Q29kZSA9PSA0Nikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucmVtb3ZlKHNlbGYuc2VsZWN0ZWQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGUuY3RybEtleSAmJiBlLmtleUNvZGUgPT0gODIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGV2ZW50ID0+IHtcblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgbmV3IEFwcGxpY2F0aW9uLlBvc3RtYW4oe1xuICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdDb21wb3VuZFByaXZhdGUvc3RvcmUnLFxuICAgICAgICAgICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnQ09NUE9ORU5UUydcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9KS50aGVuKChlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3RvcmUuY29tcG9uZW50cyA9IGUuZGF0YTtcbiAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZSkgPT4ge1xuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBuZXcgQXBwbGljYXRpb24uUG9zdG1hbih7XG4gICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0NvbXBvdW5kUHJpdmF0ZS9zdG9yZScsXG4gICAgICAgICAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdURU1QTEFURVMnXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSkudGhlbigoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN0b3JlLnRlbXBsYXRlcyA9IGUuZGF0YTtcbiAgICAgICAgICAgICAgICB9KS5jYXRjaCgoZSkgPT4ge1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBtZXRob2RzOiB7XG5cbiAgICAgICAgICAgICAgICBfX2VkaXRvcjogZnVuY3Rpb24gKHRlbXBsYXRlLCBhcmVhKSB7XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdG9yZS50ZW1wbGF0ZXNbdGVtcGxhdGVdWydlZGl0b3InXVthcmVhXTtcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHt9O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgIF9fYWJvdXQ6IGZ1bmN0aW9uIChjb21wb25lbnQpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodHlwZW9mIHRoaXMuc3RvcmUuY29tcG9uZW50c1tjb21wb25lbnQuY29tcG9uZW50XSAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHR5cGVvZiB0aGlzLnN0b3JlLmNvbXBvbmVudHNbY29tcG9uZW50LmNvbXBvbmVudF0uYWJvdXQgIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5zdG9yZS5jb21wb25lbnRzW2NvbXBvbmVudC5jb21wb25lbnRdLmFib3V0O1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIlVuZGVmaW5lZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVW5kZWZpbmVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBpY29uOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICBfX2dldE1hcmt1cDogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgQXBwbGljYXRpb24uUG9zdG1hbih7XG4gICAgICAgICAgICAgICAgICAgICAgICBtZXRob2Q6ICdDb21wb3VuZFByaXZhdGUvbWFya3VwJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZDogQXBwbGljYXRpb24uQ29uc3RhbnRzLldvcmRQcmVzcy5JRFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGNvZGUpIHtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLnRoZXJlQ3JpdGljYWxFcnJvciA9ICh7XG4gICAgICAgICAgICAgICAgICAgICAgICA5MDE6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ1RlbXBsYXRlIGNvZGUgaXMgYnJva2VuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1lvdXIgdGVtcGxhdGUgY29kZSBpcyBjb3JydXB0ZWQuIE1vc3QgbGlrZWx5IGJlY2F1c2UgeW91IG1hZGUgYSBtaXN0YWtlIHdoZW4gbWFudWFsbHkgZWRpdGluZyB0aGUgZG9jdW1lbnQuJyArXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiPGJyPlBsZWFzZSByZXZlcnQgdGhlIGRvY3VtZW50IHRvIGFuIGVhcmxpZXIgdmVyc2lvbiBvciByZWNyZWF0ZSB0aGUgcGFnZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KVtjb2RlXTtcblxuICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgICAgICAgICBqUXVlcnkoJy5fX2NvbXBvdW5kX2VkaXRvcl9hcmVhJykuYWRkQ2xhc3MoJ19fY29tcG91bmRfYWxtb3N0X2luYWNjZXNzaWJsZScpO1xuXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9fZ2V0TWFya3VwKCkudGhlbihldmVudCA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5zdGF0dXMgPT0gNTAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5lcnJvcig5MDEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQuZGF0YS5kb2N1bWVudCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgalF1ZXJ5KCcudWktc2VsZWN0ZWQnKS5yZW1vdmVDbGFzcygndWktc2VsZWN0ZWQnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZG9jdW1lbnQgPSBPYmplY3QuZnJlZXplKGV2ZW50LmRhdGEuZG9jdW1lbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc3R5bGUgPSBPYmplY3QuZnJlZXplKGV2ZW50LmRhdGEuc3R5bGUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZG9jdW1lbnQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChldmVudCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgfSkuZmluYWxseShldmVudCA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGpRdWVyeSgnLl9fY29tcG91bmRfZWRpdG9yX2FyZWEnKS5yZW1vdmVDbGFzcygnX19jb21wb3VuZF9hbG1vc3RfaW5hY2Nlc3NpYmxlJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgZWRpdENvbXBvbmVudDogZnVuY3Rpb24gKCRldmVudCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gQXBwbGljYXRpb24uTW9kdWxlcy5Db21wb3VuZE1vZGFsLnZ1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29tcG9uZW50ID0gQXBwbGljYXRpb24uQ29tcG9uZW50cy5Db21wb3VuZC5FZGl0Q29tcG9uZW50O1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCRldmVudC50YXJnZXQuYXR0cmlidXRlcylcblxuICAgICAgICAgICAgICAgICAgICBtb2RhbC5tb3VudChjb21wb25lbnQpO1xuICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFBhZ2VJRDogQXBwbGljYXRpb24uQ29uc3RhbnRzLldvcmRQcmVzcy5JRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIEFyZWE6ICRldmVudC50YXJnZXQuYXR0cmlidXRlc1snZGF0YS1jb21wb3VuZC1hcmVhJ10udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBUZW1wbGF0ZTogJGV2ZW50LnRhcmdldC5hdHRyaWJ1dGVzWydkYXRhLWNvbXBvdW5kLXRlbXBsYXRlJ10udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBJbmRleDogJGV2ZW50LnRhcmdldC5hdHRyaWJ1dGVzWydkYXRhLWNvbXBvdW5kLWluZGV4J10udmFsdWUsXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIENvbXBvbmVudDogJGV2ZW50LnRhcmdldC5hdHRyaWJ1dGVzWydkYXRhLWNvbXBvdW5kLWNvbXBvbmVudCddLnZhbHVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgRG9jdW1lbnQ6IHRoaXMuZG9jdW1lbnRcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgaW5zZXJ0VGVtcGxhdGU6IGZ1bmN0aW9uICgkZXZlbnQpIHtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBtb2RhbCA9IEFwcGxpY2F0aW9uLk1vZHVsZXMuQ29tcG91bmRNb2RhbC52dWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IEFwcGxpY2F0aW9uLkNvbXBvbmVudHMuQ29tcG91bmQuSW5zZXJ0VGVtcGxhdGU7XG5cbiAgICAgICAgICAgICAgICAgICAgbW9kYWwubW91bnQoY29tcG9uZW50KTtcbiAgICAgICAgICAgICAgICAgICAgbW9kYWwub3Blbih7XG4gICAgICAgICAgICAgICAgICAgICAgICBQYWdlSUQ6IEFwcGxpY2F0aW9uLkNvbnN0YW50cy5Xb3JkUHJlc3MuSUQsXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlczogdGhpcy5zdG9yZS50ZW1wbGF0ZXNcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgaW5zZXJ0Q29tcG9uZW50OiBmdW5jdGlvbiAoJGV2ZW50KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbW9kYWwgPSBBcHBsaWNhdGlvbi5Nb2R1bGVzLkNvbXBvdW5kTW9kYWwudnVlO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb21wb25lbnQgPSBBcHBsaWNhdGlvbi5Db21wb25lbnRzLkNvbXBvdW5kLkluc2VydENvbXBvbmVudDtcblxuICAgICAgICAgICAgICAgICAgICBtb2RhbC5tb3VudChjb21wb25lbnQpO1xuICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFBhZ2VJRDogQXBwbGljYXRpb24uQ29uc3RhbnRzLldvcmRQcmVzcy5JRCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6ICRldmVudC50YXJnZXQuYXR0cmlidXRlc1snZGF0YS1jb21wb3VuZC1wYXRoJ10udmFsdWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21wb25lbnRzOiB0aGlzLnN0b3JlLmNvbXBvbmVudHNcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgZHVibGljYXRlOiBmdW5jdGlvbiAodGVtcGxhdGVzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgbmV3IEFwcGxpY2F0aW9uLlBvc3RtYW4oe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnQ29tcG91bmRQcml2YXRlL3RlbXBsYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWdlSUQ6IEFwcGxpY2F0aW9uLkNvbnN0YW50cy5Xb3JkUHJlc3MuSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ0RVQkxJQ0FURScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgRFVCTElDQVRFOiB0ZW1wbGF0ZXMgfHwgdGhpcy5zZWxlY3RlZFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSkudGhlbigoZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgICAgIHJlbW92ZTogZnVuY3Rpb24gKHRlbXBsYXRlcykge1xuXG4gICAgICAgICAgICAgICAgICAgIG5ldyBBcHBsaWNhdGlvbi5Qb3N0bWFuKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1ldGhvZDogJ0NvbXBvdW5kUHJpdmF0ZS90ZW1wbGF0ZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBib2R5OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFnZUlEOiBBcHBsaWNhdGlvbi5Db25zdGFudHMuV29yZFByZXNzLklELFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdERUxFVEUnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIERFTEVURTogdGVtcGxhdGVzIHx8IHRoaXMuc2VsZWN0ZWRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKChlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgICAgICB1cGRhdGVPcmRlcjogZnVuY3Rpb24gKG9yZGVyKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgbmV3IEFwcGxpY2F0aW9uLlBvc3RtYW4oe1xuICAgICAgICAgICAgICAgICAgICAgICAgbWV0aG9kOiAnQ29tcG91bmRQcml2YXRlL3RlbXBsYXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYWdlSUQ6IEFwcGxpY2F0aW9uLkNvbnN0YW50cy5Xb3JkUHJlc3MuSUQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ09SREVSJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBPUkRFUjogb3JkZXIgfHwgW11cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0pLmZpbmFsbHkoKGUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG5cbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgX21vdXNlb3ZlclRlbXBsYXRlVG9vbHM6IGZ1bmN0aW9uICgkZXZlbnQpIHtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250YWluZXIgPSBqUXVlcnkoJGV2ZW50LnRhcmdldCkuY2xvc2VzdCgnLl9fY29tcG91bmRfZWRpdG9yX3RlbXBsYXRlJykuZmluZCgnW2RhdGEtc2VsZWN0ZWRdJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmF0dHIoJ2RhdGEtc2VsZWN0ZWQnLCAndHJ1ZScpO1xuICAgICAgICAgICAgICAgICAgICBqUXVlcnkoXCIjY29tcG91bmRfbGF5b3V0XCIpLnNvcnRhYmxlKFwib3B0aW9uXCIsIFwiZGlzYWJsZWRcIiwgZmFsc2UpO1xuXG5cbiAgICAgICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICAgICAgX21vdXNlbGVhdmVUZW1wbGF0ZVRvb2xzOiBmdW5jdGlvbiAoJGV2ZW50KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0galF1ZXJ5KCRldmVudC50YXJnZXQpLmNsb3Nlc3QoJy5fX2NvbXBvdW5kX2VkaXRvcl90ZW1wbGF0ZScpLmZpbmQoJ1tkYXRhLXNlbGVjdGVkXScpO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5hdHRyKCdkYXRhLXNlbGVjdGVkJywgJ2ZhbHNlJyk7XG4gICAgICAgICAgICAgICAgICAgIGpRdWVyeShcIiNjb21wb3VuZF9sYXlvdXRcIikuc29ydGFibGUoXCJvcHRpb25cIiwgXCJkaXNhYmxlZFwiLCB0cnVlKTtcblxuICAgICAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgcmVhZHk6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB9XG4gICAgfSk7XG5cbn0iXX0=