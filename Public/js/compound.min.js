"use strict";const $page=parseInt(jQuery("meta[name=\"page\"]").attr("content")),CompoundEditor=Project.export("editor",new Interface({requires:{vue:!0,jquery:!0},elements:{vue:["#compound-editor-body"]},vue:{delimiters:["{","}"],el:"#compound-editor-body",data:{markup:[]},mounted:function(){this.__updateMarkup().then(()=>{jQuery("[data-component=\"body\"][data-namespace=\"editor\"]").removeClass("hidden"),jQuery("[data-component=\"spinner\"][data-namespace=\"editor\"]").addClass("hidden"),jQuery("[data-behavior=\"sortable\"]").sortable({disabled:!0,tolerance:"pointer",placeholder:"wp-mrl-placeholder",connectWith:jQuery("[data-behavior=\"droppable\"][data-namespace=\"editor\"]"),helper:"clone",opacity:.5,cursor:"move",forcePlaceholderSize:!0,revert:80,update:function(){var a=[];for(const[b,c]of Object.entries(jQuery("[data-component=\"field\"][data-namespace=\"editor\"]"))){const b=jQuery(c).attr("data-id");b&&a.push(b)}new WPAjax("Compound-sort",{page:$page,order:a})},start:(a,b)=>{jQuery("[data-role=\"trash\"][data-namespace=\"editor\"]").removeClass("hidden"),this.__renderDroppable(),this.__renderPlaceholder(b)},stop:()=>{jQuery("[data-behavior=\"sortable\"]").sortable("option","disabled",!0),jQuery("[data-role=\"trash\"][data-namespace=\"editor\"]").addClass("hidden")}})}).catch(()=>{jQuery("[data-component=\"error\"][data-namespace=\"editor\"]").removeClass("hidden"),jQuery("[data-component=\"spinner\"][data-namespace=\"editor\"]").addClass("hidden")})},methods:{editProps:function(a){const b=Project.import("@form-props").vue;return b.__editor=this,b.open(Object.assign({page:$page},a))},insertComponent:function(a){const b=Project.import("@form-createComponent").vue;return b.__editor=this,b.open(Object.assign({page:$page},a))},insertTemplate:function(a){const b=Project.import("@form-insertTemplate").vue;return b.__editor=this,b.open(Object.assign({page:$page},a))},removeTemplate:function(a,b){return new WPAjax("Compound-removeTemplate",{page:a,template:b})},__move_enabled:function(){jQuery("[data-behavior=\"sortable\"]").sortable("option","disabled",!1)},__menu_action_remove_template:function(a){const b=new WPAjax("Compound-removeTemplate",{page:$page,template:a.template});b.then(()=>{this.__updateMarkup()}).catch(()=>{})},__metaFieldClass__:function(a){const b=(a||{}).editor||{};return`wp-mrl-field col-${b.col||12}`},__updateMarkup:function(){return new Promise((a,b)=>{const c=new WPAjax("Compound-getMarkup",{page:$page});c.then(b=>{var c=[];for(const[a,d]of Object.entries(b.data.data))c.push({name:d.props.name||"default",id:a,fields:d.fields,props:d.props});this.markup=c,a(b.data.data)}).catch(a=>{b(a)})})},__renderDroppable:function(){return jQuery("[data-behavior=\"droppable\"]").droppable({accept:jQuery("[data-component=\"field\"][data-namespace=\"editor\"]"),activeClass:"wp-mrl-trash-active",hoverClass:"wp-mrl-trash-hover",drop:(a,b)=>{const c=jQuery(b.helper.context).attr("data-id");this.removeTemplate($page,c),b.draggable.remove()}})},__renderPlaceholder:function(a){return a.placeholder.height(a.item.height())}}},ready:function(){}}));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBYixFQVFKLEtBQUssTUFBTCxDQUFjLENBYkksQ0FnQmxCLENBQU8sQ0FBQyxDQUFLLENBQUMsSUFBTixDQUFXLElBQVosQ0FFVixDQWxCRCxFQWtCRyxLQWxCSCxDQWtCUyxDQUFLLEVBQUksQ0FHZCxDQUFNLENBQUMsQ0FBRCxDQUVULENBdkJELENBd0JILENBL0JNLENBZ0NWLENBekZJLENBMkZMLGlCQUFpQixDQUFFLFVBQWlCLENBQ2hDLE1BQU8sQ0FBQSxNQUFNLENBQUMsK0JBQUQsQ0FBTixDQUFzQyxTQUF0QyxDQUFnRCxDQUNuRCxNQUFNLENBQUUsTUFBTSxDQUFDLHVEQUFELENBRHFDLENBRW5ELFdBQVcsQ0FBRSxxQkFGc0MsQ0FHbkQsVUFBVSxDQUFFLG9CQUh1QyxDQUtuRCxJQUFJLENBQUUsQ0FBQyxDQUFELENBQVEsQ0FBUixHQUFlLENBQ2pCLEtBQU0sQ0FBQSxDQUFTLENBQUcsTUFBTSxDQUFDLENBQUUsQ0FBQyxNQUFILENBQVUsT0FBWCxDQUFOLENBQTBCLElBQTFCLENBQStCLFNBQS9CLENBQWxCLENBQ0EsS0FBSyxjQUFMLENBQW9CLEtBQXBCLENBQTJCLENBQTNCLENBRmlCLENBR2pCLENBQUUsQ0FBQyxTQUFILENBQWEsTUFBYixFQUNILENBVGtELENBQWhELENBV1YsQ0F2R0ksQ0F5R0wsbUJBQW1CLENBQUUsU0FBVSxDQUFWLENBQWlCLENBQ2xDLE1BQU8sQ0FBQSxDQUFLLENBQUMsV0FBTixDQUFrQixNQUFsQixDQUF5QixDQUFLLENBQUMsSUFBTixDQUFXLE1BQVgsRUFBekIsQ0FDVixDQTNHSSxDQW5FUixDQVJxRCxDQXlMMUQsS0FBSyxDQUFFLFVBQW9CLENBRTFCLENBM0x5RCxDQUFkLENBQXpCLEMiLCJmaWxlIjoiY29tcG91bmQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBXZWxjb21lIHRvIHRoZSBzb3VyY2UgY29kZVxuICpcbiAqIOKWiOKWiOKWiOKVl+KWkeKWkeKWkeKWiOKWiOKWiOKVl+KWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKVl+KWkeKWkeKWkeKWkeKWkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVlyAgICAgICAg4paR4paR4paR4paR4paR4paI4paI4pWX4paR4paI4paI4paI4paI4paI4paI4pWXXG4gKiDilojilojilojilojilZfilpHilojilojilojilojilZHilojilojilZHilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilZDilZDilZ3ilojilojilZHilpHilpHilpHilpHilpHilojilojilZTilZDilZDilZDilZDilZ0gICAgICAgIOKWkeKWkeKWkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVnVxuICog4paI4paI4pWU4paI4paI4paI4paI4pWU4paI4paI4pWR4paI4paI4pWR4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4pWX4paR4paR4paI4paI4pWR4paR4paR4paR4paR4paR4paI4paI4paI4paI4paI4pWX4paR4paRICAgICAgICDilpHilpHilpHilpHilpHilojilojilZHilZrilojilojilojilojilojilZfilpFcbiAqIOKWiOKWiOKVkeKVmuKWiOKWiOKVlOKVneKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKVneKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkeKWkeKWkeKWiOKWiOKVlOKVkOKVkOKVneKWkeKWkSAgICAgICAg4paI4paI4pWX4paR4paR4paI4paI4pWR4paR4pWa4pWQ4pWQ4pWQ4paI4paI4pWXXG4gKiDilojilojilZHilpHilZrilZDilZ3ilpHilojilojilZHilojilojilZHilojilojilZHilpHilpHilojilojilZHilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilZcgICAgICAgIOKVmuKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVnVxuICog4pWa4pWQ4pWd4paR4paR4paR4paR4paR4pWa4pWQ4pWd4pWa4pWQ4pWd4pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWdICAgICAgICDilpHilZrilZDilZDilZDilZDilZ3ilpHilZrilZDilZDilZDilZDilZDilZ3ilpFcbiAqXG4gKiDilpHilojilojilojilojilojilZfilpHilojilojilojilojilojilojilZfilpHilojilojilojilZfilpHilpHilpHilojilojilojilZfilojilojilZfilojilojilojilZfilpHilpHilojilojilZfilojilojilZfilpHilojilojilojilojilojilojilZfilojilojilojilojilojilojilojilojilZfilojilojilojilojilojilojilZfilpHilpHilojilojilojilojilojilZfilpHilojilojilojilojilojilojilojilojilZfilpHilojilojilojilojilojilZfilpHilojilojilojilojilojilojilZfilpFcbiAqIOKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKWiOKWiOKVlOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KVmuKVkOKVkOKWiOKWiOKVlOKVkOKVkOKVneKWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl+KWiOKWiOKVlOKVkOKVkOKWiOKWiOKVl1xuICog4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4pWR4paR4paR4paI4paI4pWR4paI4paI4pWU4paI4paI4paI4paI4pWU4paI4paI4pWR4paI4paI4pWR4paI4paI4pWU4paI4paI4pWX4paI4paI4pWR4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4pWX4paR4paR4paR4paR4paI4paI4pWR4paR4paR4paR4paI4paI4paI4paI4paI4paI4pWU4pWd4paI4paI4paI4paI4paI4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4paR4paR4paI4paI4pWR4paI4paI4paI4paI4paI4paI4pWU4pWdXG4gKiDilojilojilZTilZDilZDilojilojilZHilojilojilZHilpHilpHilojilojilZHilojilojilZHilZrilojilojilZTilZ3ilojilojilZHilojilojilZHilojilojilZHilZrilojilojilojilojilZHilojilojilZHilpHilZrilZDilZDilZDilojilojilZfilpHilpHilpHilojilojilZHilpHilpHilpHilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilojilojilZHilpHilpHilpHilojilojilZHilpHilpHilpHilojilojilZHilpHilpHilojilojilZHilojilojilZTilZDilZDilojilojilZdcbiAqIOKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkeKWkeKVmuKVkOKVneKWkeKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKVkeKWkeKVmuKWiOKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkeKVmuKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkVxuICog4pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paR4pWa4pWQ4pWd4paR4paR4paR4paR4paR4pWa4pWQ4pWd4pWa4pWQ4pWd4pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWQ4pWd4pWa4pWQ4pWd4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paR4paR4paR4paR4pWa4pWQ4pWd4paR4paR4paR4pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWd4pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWd4paR4paR4paR4pWa4pWQ4pWd4paR4paR4paR4paR4pWa4pWQ4pWQ4pWQ4pWQ4pWd4paR4pWa4pWQ4pWd4paR4paR4pWa4pWQ4pWdXG4gKlxuICpcbiAqXG4gKiBAcGFja2FnZSBNaXJlbGVcbiAqIEBhdXRob3IgTWlyZWxlXG4gKiBAdmVyc2lvbiAxLjAuMFxuICpcbiAqIEBzZWUgaHR0cHM6Ly92dWVqcy5vcmcvdjIvZ3VpZGUvXG4gKi9cblxuXCJ1c2Ugc3RyaWN0XCI7XG5cbmNvbnN0ICRwYWdlID0gcGFyc2VJbnQoalF1ZXJ5KCdtZXRhW25hbWU9XCJwYWdlXCJdJykuYXR0cignY29udGVudCcpKTtcblxuY29uc3QgQ29tcG91bmRFZGl0b3IgPSBQcm9qZWN0LmV4cG9ydCgnZWRpdG9yJywgbmV3IEludGVyZmFjZSh7XG4gICAgcmVxdWlyZXM6IHtcbiAgICAgICAgdnVlOiB0cnVlLFxuICAgICAgICBqcXVlcnk6IHRydWVcbiAgICB9LFxuICAgIGVsZW1lbnRzOiB7XG4gICAgICAgIHZ1ZTogWycjY29tcG91bmQtZWRpdG9yLWJvZHknXVxuICAgIH0sXG4gICAgdnVlOiB7XG4gICAgICAgIGRlbGltaXRlcnM6IFsneycsICd9J10sXG4gICAgICAgIGVsOiBcIiNjb21wb3VuZC1lZGl0b3ItYm9keVwiLFxuICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICBtYXJrdXA6IFtdXG4gICAgICAgIH0sXG4gICAgICAgIG1vdW50ZWQ6IGZ1bmN0aW9uIChFdmVudCkge1xuXG4gICAgICAgICAgICB0aGlzLl9fdXBkYXRlTWFya3VwKCkudGhlbihEYXRhID0+IHtcblxuICAgICAgICAgICAgICAgIGpRdWVyeSgnW2RhdGEtY29tcG9uZW50PVwiYm9keVwiXVtkYXRhLW5hbWVzcGFjZT1cImVkaXRvclwiXScpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICAgICBqUXVlcnkoJ1tkYXRhLWNvbXBvbmVudD1cInNwaW5uZXJcIl1bZGF0YS1uYW1lc3BhY2U9XCJlZGl0b3JcIl0nKS5hZGRDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgalF1ZXJ5KCdbZGF0YS1iZWhhdmlvcj1cInNvcnRhYmxlXCJdJykuc29ydGFibGUoe1xuXG4gICAgICAgICAgICAgICAgICAgIGRpc2FibGVkOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB0b2xlcmFuY2U6IFwicG9pbnRlclwiLFxuICAgICAgICAgICAgICAgICAgICBwbGFjZWhvbGRlcjogXCJ3cC1tcmwtcGxhY2Vob2xkZXJcIixcbiAgICAgICAgICAgICAgICAgICAgY29ubmVjdFdpdGg6IGpRdWVyeSgnW2RhdGEtYmVoYXZpb3I9XCJkcm9wcGFibGVcIl1bZGF0YS1uYW1lc3BhY2U9XCJlZGl0b3JcIl0nKSxcbiAgICAgICAgICAgICAgICAgICAgaGVscGVyOiAnY2xvbmUnLFxuICAgICAgICAgICAgICAgICAgICBvcGFjaXR5OiAwLjUsXG4gICAgICAgICAgICAgICAgICAgIGN1cnNvcjogXCJtb3ZlXCIsXG4gICAgICAgICAgICAgICAgICAgIGZvcmNlUGxhY2Vob2xkZXJTaXplOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICByZXZlcnQ6IDgwLFxuXG4gICAgICAgICAgICAgICAgICAgIHVwZGF0ZTogZnVuY3Rpb24gKGV2ZW50LCB1aSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgJG9yZGVyID0gW107XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgW2luZGV4LCBlbGVtZW50XSBvZiBPYmplY3QuZW50cmllcyhqUXVlcnkoJ1tkYXRhLWNvbXBvbmVudD1cImZpZWxkXCJdW2RhdGEtbmFtZXNwYWNlPVwiZWRpdG9yXCJdJykpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgJGlkID0galF1ZXJ5KGVsZW1lbnQpLmF0dHIoJ2RhdGEtaWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJGlkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICRvcmRlci5wdXNoKCRpZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBSZXF1ZXN0ID0gbmV3IFdQQWpheCgnQ29tcG91bmQtc29ydCcsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlOiAkcGFnZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcmRlcjogJG9yZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzdGFydDogKGV2ZW50LCB1aSkgPT4ge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBqUXVlcnkoJ1tkYXRhLXJvbGU9XCJ0cmFzaFwiXVtkYXRhLW5hbWVzcGFjZT1cImVkaXRvclwiXScpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fX3JlbmRlckRyb3BwYWJsZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fX3JlbmRlclBsYWNlaG9sZGVyKHVpKTtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzdG9wOiAoZXZlbnQsIHVpKSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGpRdWVyeSgnW2RhdGEtYmVoYXZpb3I9XCJzb3J0YWJsZVwiXScpLnNvcnRhYmxlKFwib3B0aW9uXCIsIFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBqUXVlcnkoJ1tkYXRhLXJvbGU9XCJ0cmFzaFwiXVtkYXRhLW5hbWVzcGFjZT1cImVkaXRvclwiXScpLmFkZENsYXNzKCdoaWRkZW4nKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pLmNhdGNoKERhdGEgPT4ge1xuXG4gICAgICAgICAgICAgICAgalF1ZXJ5KCdbZGF0YS1jb21wb25lbnQ9XCJlcnJvclwiXVtkYXRhLW5hbWVzcGFjZT1cImVkaXRvclwiXScpLnJlbW92ZUNsYXNzKCdoaWRkZW4nKTtcbiAgICAgICAgICAgICAgICBqUXVlcnkoJ1tkYXRhLWNvbXBvbmVudD1cInNwaW5uZXJcIl1bZGF0YS1uYW1lc3BhY2U9XCJlZGl0b3JcIl0nKS5hZGRDbGFzcygnaGlkZGVuJyk7XG5cbiAgICAgICAgICAgIH0pO1xuXG5cbiAgICAgICAgfSxcbiAgICAgICAgbWV0aG9kczoge1xuXG4gICAgICAgICAgICBlZGl0UHJvcHM6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGNvbnN0ICRmb3JtID0gUHJvamVjdC5pbXBvcnQoJ0Bmb3JtLXByb3BzJykudnVlO1xuICAgICAgICAgICAgICAgICRmb3JtLl9fZWRpdG9yID0gdGhpcztcbiAgICAgICAgICAgICAgICByZXR1cm4gJGZvcm0ub3BlbihPYmplY3QuYXNzaWduKHtcbiAgICAgICAgICAgICAgICAgICAgcGFnZTogJHBhZ2VcbiAgICAgICAgICAgICAgICB9LCBldmVudCkpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgaW5zZXJ0Q29tcG9uZW50OiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCAkZm9ybSA9IFByb2plY3QuaW1wb3J0KCdAZm9ybS1jcmVhdGVDb21wb25lbnQnKS52dWU7XG4gICAgICAgICAgICAgICAgJGZvcm0uX19lZGl0b3IgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHJldHVybiAkZm9ybS5vcGVuKE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgICAgICAgICBwYWdlOiAkcGFnZSxcbiAgICAgICAgICAgICAgICB9LCBldmVudCkpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgaW5zZXJ0VGVtcGxhdGU6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGNvbnN0ICRmb3JtID0gUHJvamVjdC5pbXBvcnQoJ0Bmb3JtLWluc2VydFRlbXBsYXRlJykudnVlO1xuICAgICAgICAgICAgICAgICRmb3JtLl9fZWRpdG9yID0gdGhpcztcbiAgICAgICAgICAgICAgICByZXR1cm4gJGZvcm0ub3BlbihPYmplY3QuYXNzaWduKHtcbiAgICAgICAgICAgICAgICAgICAgcGFnZTogJHBhZ2UsXG4gICAgICAgICAgICAgICAgfSwgZXZlbnQpKTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIHJlbW92ZVRlbXBsYXRlOiBmdW5jdGlvbiAocGFnZSwgdGVtcGxhdGUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV3IFdQQWpheCgnQ29tcG91bmQtcmVtb3ZlVGVtcGxhdGUnLCB7XG4gICAgICAgICAgICAgICAgICAgIHBhZ2U6IHBhZ2UsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiB0ZW1wbGF0ZVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgX19tb3ZlX2VuYWJsZWQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGpRdWVyeSgnW2RhdGEtYmVoYXZpb3I9XCJzb3J0YWJsZVwiXScpLnNvcnRhYmxlKFwib3B0aW9uXCIsIFwiZGlzYWJsZWRcIiwgZmFsc2UpO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgX19tZW51X2FjdGlvbl9yZW1vdmVfdGVtcGxhdGU6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IFJlcXVlc3QgPSBuZXcgV1BBamF4KCdDb21wb3VuZC1yZW1vdmVUZW1wbGF0ZScsIHtcbiAgICAgICAgICAgICAgICAgICAgcGFnZTogJHBhZ2UsXG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlOiBldmVudC50ZW1wbGF0ZVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgUmVxdWVzdC50aGVuKEV2ZW50ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fX3VwZGF0ZU1hcmt1cCgpO1xuICAgICAgICAgICAgICAgIH0pLmNhdGNoKEV2ZW50ID0+IHtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgX19tZXRhRmllbGRDbGFzc19fOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBjb25zdCAkZXZlbnQgPSBldmVudCB8fCB7fTtcbiAgICAgICAgICAgICAgICBjb25zdCAkZWRpdG9yID0gJGV2ZW50LmVkaXRvciB8fCB7fTtcbiAgICAgICAgICAgICAgICByZXR1cm4gYHdwLW1ybC1maWVsZCBjb2wtJHskZWRpdG9yLmNvbCB8fCAxMn1gO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgX191cGRhdGVNYXJrdXA6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIG1haW4gcmVxdWVzdFxuICAgICAgICAgICAgICAgICAgICBjb25zdCBSZXF1ZXN0ID0gbmV3IFdQQWpheCgnQ29tcG91bmQtZ2V0TWFya3VwJywge1xuICAgICAgICAgICAgICAgICAgICAgICAgcGFnZTogJHBhZ2VcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgUmVxdWVzdC50aGVuKEV2ZW50ID0+IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyICRidWZmZXIgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBbaWQsIHRlbXBsYXRlXSBvZiBPYmplY3QuZW50cmllcyhFdmVudC5kYXRhLmRhdGEpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJGJ1ZmZlci5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogdGVtcGxhdGUucHJvcHMubmFtZSB8fCAnZGVmYXVsdCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRzOiB0ZW1wbGF0ZS5maWVsZHMsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb3BzOiB0ZW1wbGF0ZS5wcm9wc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1hcmt1cCA9ICRidWZmZXI7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlc29sdmVcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoRXZlbnQuZGF0YS5kYXRhKTtcblxuICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChFdmVudCA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlamVjdFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KEV2ZW50KTtcblxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIF9fcmVuZGVyRHJvcHBhYmxlOiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4galF1ZXJ5KCdbZGF0YS1iZWhhdmlvcj1cImRyb3BwYWJsZVwiXScpLmRyb3BwYWJsZSh7XG4gICAgICAgICAgICAgICAgICAgIGFjY2VwdDogalF1ZXJ5KCdbZGF0YS1jb21wb25lbnQ9XCJmaWVsZFwiXVtkYXRhLW5hbWVzcGFjZT1cImVkaXRvclwiXScpLFxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVDbGFzczogJ3dwLW1ybC10cmFzaC1hY3RpdmUnLFxuICAgICAgICAgICAgICAgICAgICBob3ZlckNsYXNzOiAnd3AtbXJsLXRyYXNoLWhvdmVyJyxcblxuICAgICAgICAgICAgICAgICAgICBkcm9wOiAoZXZlbnQsIHVpKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCAkdGVtcGxhdGUgPSBqUXVlcnkodWkuaGVscGVyLmNvbnRleHQpLmF0dHIoJ2RhdGEtaWQnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlVGVtcGxhdGUoJHBhZ2UsICR0ZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB1aS5kcmFnZ2FibGUucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIF9fcmVuZGVyUGxhY2Vob2xkZXI6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBldmVudC5wbGFjZWhvbGRlci5oZWlnaHQoZXZlbnQuaXRlbS5oZWlnaHQoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHJlYWR5OiBmdW5jdGlvbiAoRXZlbnQsICQpIHtcblxuICAgIH1cbn0pKTsiXX0=