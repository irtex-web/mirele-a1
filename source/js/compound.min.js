"use strict";const $page=parseInt(jQuery("meta[name=\"page\"]").attr("content")),CompoundEditor=Project.export("editor",new Interface({requires:{vue:!0,jquery:!0},elements:{vue:["#compound-editor-body"]},vue:{delimiters:["{","}"],el:"#compound-editor-body",data:{markup:[]},mounted:function(){this.__updateMarkup().then(()=>{jQuery("[data-component=\"body\"][data-namespace=\"editor\"]").removeClass("hidden"),jQuery("[data-component=\"spinner\"][data-namespace=\"editor\"]").addClass("hidden"),jQuery("[data-behavior=\"sortable\"]").sortable({tolerance:"pointer",placeholder:"wp-mrl-placeholder",connectWith:jQuery("[data-behavior=\"droppable\"][data-namespace=\"editor\"]"),helper:"clone",opacity:.5,cursor:"move",forcePlaceholderSize:!0,revert:80,update:function(){var a=[];for(const[b,c]of Object.entries(jQuery("[data-component=\"field\"][data-namespace=\"editor\"]"))){const b=jQuery(c).attr("data-id");b&&a.push(b)}new WPAjax("Compound-sort",{page:$page,order:a})},start:(a,b)=>{jQuery("[data-role=\"trash\"][data-namespace=\"editor\"]").removeClass("hidden"),this.__renderDroppable(),this.__renderPlaceholder(b)},stop:()=>{jQuery("[data-role=\"trash\"][data-namespace=\"editor\"]").addClass("hidden")}})}).catch(()=>{jQuery("[data-component=\"error\"][data-namespace=\"editor\"]").removeClass("hidden"),jQuery("[data-component=\"spinner\"][data-namespace=\"editor\"]").addClass("hidden")})},methods:{editProps:function(a){const b=Project.import("@form-props").vue;return b.__editor=this,b.open(Object.assign({page:$page},a))},insertComponent:function(a){const b=Project.import("@form-createComponent").vue;return b.__editor=this,b.open(Object.assign({page:$page},a))},__metaFieldClass__:function(a){const b=(a||{}).editor||{};return`wp-mrl-field col-${b.col||12}`},__updateMarkup:function(){return new Promise((a,b)=>{const c=new WPAjax("Compound-getMarkup",{page:$page});c.then(b=>{var c=[];for(const[a,d]of Object.entries(b.data.data))c.push({name:d.props.name||"default",id:a,fields:d.fields,props:d.props});this.markup=c,a(b.data.data)}).catch(a=>{b(a)})})},__renderDroppable:function(){return jQuery("[data-behavior=\"droppable\"]").droppable({accept:jQuery("[data-component=\"field\"][data-namespace=\"editor\"]"),activeClass:"wp-mrl-trash-active",hoverClass:"wp-mrl-trash-hover",drop:function(a,b){const c=jQuery(b.helper.context).attr("data-id"),d=jQuery(b.helper.context).attr("data-page-id"),e=new WPAjax("Compound-removeTemplate",{id:d,template:c});b.draggable.remove()}})},__renderPlaceholder:function(a){return a.placeholder.height(a.item.height())}}},ready:function(){}}));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QXpCLENBQ1YsQ0FuRkksQ0FoRVIsQ0FScUQsQ0E4SjFELEtBQUssQ0FBRSxVQUFvQixDQUUxQixDQWhLeUQsQ0FBZCxDQUF6QixDIiwiZmlsZSI6ImNvbXBvdW5kLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogV2VsY29tZSB0byB0aGUgc291cmNlIGNvZGVcbiAqXG4gKiDilojilojilojilZfilpHilpHilpHilojilojilojilZfilojilojilZfilojilojilojilojilojilojilZfilpHilojilojilojilojilojilojilojilZfilojilojilZfilpHilpHilpHilpHilpHilojilojilojilojilojilojilojilZcgICAgICAgIOKWkeKWkeKWkeKWkeKWkeKWiOKWiOKVl+KWkeKWiOKWiOKWiOKWiOKWiOKWiOKVl1xuICog4paI4paI4paI4paI4pWX4paR4paI4paI4paI4paI4pWR4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWR4paR4paR4paR4paR4paR4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWdICAgICAgICDilpHilpHilpHilpHilpHilojilojilZHilojilojilZTilZDilZDilZDilZDilZ1cbiAqIOKWiOKWiOKVlOKWiOKWiOKWiOKWiOKVlOKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkeKWkeKWkeKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWkSAgICAgICAg4paR4paR4paR4paR4paR4paI4paI4pWR4pWa4paI4paI4paI4paI4paI4pWX4paRXG4gKiDilojilojilZHilZrilojilojilZTilZ3ilojilojilZHilojilojilZHilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilZ3ilpHilpHilojilojilZHilpHilpHilpHilpHilpHilojilojilZTilZDilZDilZ3ilpHilpEgICAgICAgIOKWiOKWiOKVl+KWkeKWkeKWiOKWiOKVkeKWkeKVmuKVkOKVkOKVkOKWiOKWiOKVl1xuICog4paI4paI4pWR4paR4pWa4pWQ4pWd4paR4paI4paI4pWR4paI4paI4pWR4paI4paI4pWR4paR4paR4paI4paI4pWR4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4pWXICAgICAgICDilZrilojilojilojilojilojilZTilZ3ilojilojilojilojilojilojilZTilZ1cbiAqIOKVmuKVkOKVneKWkeKWkeKWkeKWkeKWkeKVmuKVkOKVneKVmuKVkOKVneKVmuKVkOKVneKWkeKWkeKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVnSAgICAgICAg4paR4pWa4pWQ4pWQ4pWQ4pWQ4pWd4paR4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paRXG4gKlxuICog4paR4paI4paI4paI4paI4paI4pWX4paR4paI4paI4paI4paI4paI4paI4pWX4paR4paI4paI4paI4pWX4paR4paR4paR4paI4paI4paI4pWX4paI4paI4pWX4paI4paI4paI4pWX4paR4paR4paI4paI4pWX4paI4paI4pWX4paR4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4paI4paI4pWX4paI4paI4paI4paI4paI4paI4pWX4paR4paR4paI4paI4paI4paI4paI4pWX4paR4paI4paI4paI4paI4paI4paI4paI4paI4pWX4paR4paI4paI4paI4paI4paI4pWX4paR4paI4paI4paI4paI4paI4paI4pWX4paRXG4gKiDilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilojilojilZfilojilojilojilojilZfilpHilojilojilojilojilZHilojilojilZHilojilojilojilojilZfilpHilojilojilZHilojilojilZHilojilojilZTilZDilZDilZDilZDilZ3ilZrilZDilZDilojilojilZTilZDilZDilZ3ilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilojilojilZfilZrilZDilZDilojilojilZTilZDilZDilZ3ilojilojilZTilZDilZDilojilojilZfilojilojilZTilZDilZDilojilojilZdcbiAqIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKVlOKWiOKWiOKWiOKWiOKVlOKWiOKWiOKVkeKWiOKWiOKVkeKWiOKWiOKVlOKWiOKWiOKVl+KWiOKWiOKVkeKWiOKWiOKVkeKVmuKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkeKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVneKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKWkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWkeKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKVlOKVnVxuICog4paI4paI4pWU4pWQ4pWQ4paI4paI4pWR4paI4paI4pWR4paR4paR4paI4paI4pWR4paI4paI4pWR4pWa4paI4paI4pWU4pWd4paI4paI4pWR4paI4paI4pWR4paI4paI4pWR4pWa4paI4paI4paI4paI4pWR4paI4paI4pWR4paR4pWa4pWQ4pWQ4pWQ4paI4paI4pWX4paR4paR4paR4paI4paI4pWR4paR4paR4paR4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4paR4paR4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4paI4paI4pWXXG4gKiDilojilojilZHilpHilpHilojilojilZHilojilojilojilojilojilojilZTilZ3ilojilojilZHilpHilZrilZDilZ3ilpHilojilojilZHilojilojilZHilojilojilZHilpHilZrilojilojilojilZHilojilojilZHilojilojilojilojilojilojilZTilZ3ilpHilpHilpHilojilojilZHilpHilpHilpHilojilojilZHilpHilpHilojilojilZHilojilojilZHilpHilpHilojilojilZHilpHilpHilpHilojilojilZHilpHilpHilpHilZrilojilojilojilojilojilZTilZ3ilojilojilZHilpHilpHilojilojilZFcbiAqIOKVmuKVkOKVneKWkeKWkeKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVneKWkeKVmuKVkOKVneKWkeKWkeKWkeKWkeKWkeKVmuKVkOKVneKVmuKVkOKVneKVmuKVkOKVneKWkeKWkeKVmuKVkOKVkOKVneKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVneKWkeKWkeKWkeKWkeKVmuKVkOKVneKWkeKWkeKWkeKVmuKVkOKVneKWkeKWkeKVmuKVkOKVneKVmuKVkOKVneKWkeKWkeKVmuKVkOKVneKWkeKWkeKWkeKVmuKVkOKVneKWkeKWkeKWkeKWkeKVmuKVkOKVkOKVkOKVkOKVneKWkeKVmuKVkOKVneKWkeKWkeKVmuKVkOKVnVxuICpcbiAqXG4gKlxuICogQHBhY2thZ2UgTWlyZWxlXG4gKiBAYXV0aG9yIE1pcmVsZVxuICogQHZlcnNpb24gMS4wLjBcbiAqXG4gKiBAc2VlIGh0dHBzOi8vdnVlanMub3JnL3YyL2d1aWRlL1xuICovXG5cblwidXNlIHN0cmljdFwiO1xuXG5jb25zdCAkcGFnZSA9IHBhcnNlSW50KGpRdWVyeSgnbWV0YVtuYW1lPVwicGFnZVwiXScpLmF0dHIoJ2NvbnRlbnQnKSk7XG5cbmNvbnN0IENvbXBvdW5kRWRpdG9yID0gUHJvamVjdC5leHBvcnQoJ2VkaXRvcicsIG5ldyBJbnRlcmZhY2Uoe1xuICAgIHJlcXVpcmVzOiB7XG4gICAgICAgIHZ1ZTogdHJ1ZSxcbiAgICAgICAganF1ZXJ5OiB0cnVlXG4gICAgfSxcbiAgICBlbGVtZW50czoge1xuICAgICAgICB2dWU6IFsnI2NvbXBvdW5kLWVkaXRvci1ib2R5J11cbiAgICB9LFxuICAgIHZ1ZToge1xuICAgICAgICBkZWxpbWl0ZXJzOiBbJ3snLCAnfSddLFxuICAgICAgICBlbDogXCIjY29tcG91bmQtZWRpdG9yLWJvZHlcIixcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgbWFya3VwOiBbXVxuICAgICAgICB9LFxuICAgICAgICBtb3VudGVkOiBmdW5jdGlvbiAoRXZlbnQpIHtcblxuICAgICAgICAgICAgdGhpcy5fX3VwZGF0ZU1hcmt1cCgpLnRoZW4oRGF0YSA9PiB7XG5cbiAgICAgICAgICAgICAgICBqUXVlcnkoJ1tkYXRhLWNvbXBvbmVudD1cImJvZHlcIl1bZGF0YS1uYW1lc3BhY2U9XCJlZGl0b3JcIl0nKS5yZW1vdmVDbGFzcygnaGlkZGVuJyk7XG4gICAgICAgICAgICAgICAgalF1ZXJ5KCdbZGF0YS1jb21wb25lbnQ9XCJzcGlubmVyXCJdW2RhdGEtbmFtZXNwYWNlPVwiZWRpdG9yXCJdJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgICAgICAgICAgICAgalF1ZXJ5KCdbZGF0YS1iZWhhdmlvcj1cInNvcnRhYmxlXCJdJykuc29ydGFibGUoe1xuXG4gICAgICAgICAgICAgICAgICAgIHRvbGVyYW5jZTogXCJwb2ludGVyXCIsXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiBcIndwLW1ybC1wbGFjZWhvbGRlclwiLFxuICAgICAgICAgICAgICAgICAgICBjb25uZWN0V2l0aDogalF1ZXJ5KCdbZGF0YS1iZWhhdmlvcj1cImRyb3BwYWJsZVwiXVtkYXRhLW5hbWVzcGFjZT1cImVkaXRvclwiXScpLFxuICAgICAgICAgICAgICAgICAgICBoZWxwZXI6ICdjbG9uZScsXG4gICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IDAuNSxcbiAgICAgICAgICAgICAgICAgICAgY3Vyc29yOiBcIm1vdmVcIixcbiAgICAgICAgICAgICAgICAgICAgZm9yY2VQbGFjZWhvbGRlclNpemU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHJldmVydDogODAsXG5cbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlOiBmdW5jdGlvbiAoZXZlbnQsIHVpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciAkb3JkZXIgPSBbXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBbaW5kZXgsIGVsZW1lbnRdIG9mIE9iamVjdC5lbnRyaWVzKGpRdWVyeSgnW2RhdGEtY29tcG9uZW50PVwiZmllbGRcIl1bZGF0YS1uYW1lc3BhY2U9XCJlZGl0b3JcIl0nKSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCAkaWQgPSBqUXVlcnkoZWxlbWVudCkuYXR0cignZGF0YS1pZCcpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkaWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJG9yZGVyLnB1c2goJGlkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IFJlcXVlc3QgPSBuZXcgV1BBamF4KCdDb21wb3VuZC1zb3J0Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2U6ICRwYWdlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyOiAkb3JkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0OiAoZXZlbnQsIHVpKSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGpRdWVyeSgnW2RhdGEtcm9sZT1cInRyYXNoXCJdW2RhdGEtbmFtZXNwYWNlPVwiZWRpdG9yXCJdJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fX3JlbmRlckRyb3BwYWJsZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fX3JlbmRlclBsYWNlaG9sZGVyKHVpKTtcblxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzdG9wOiAoZXZlbnQsIHVpKSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGpRdWVyeSgnW2RhdGEtcm9sZT1cInRyYXNoXCJdW2RhdGEtbmFtZXNwYWNlPVwiZWRpdG9yXCJdJykuYWRkQ2xhc3MoJ2hpZGRlbicpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfSkuY2F0Y2goRGF0YSA9PiB7XG5cbiAgICAgICAgICAgICAgICBqUXVlcnkoJ1tkYXRhLWNvbXBvbmVudD1cImVycm9yXCJdW2RhdGEtbmFtZXNwYWNlPVwiZWRpdG9yXCJdJykucmVtb3ZlQ2xhc3MoJ2hpZGRlbicpO1xuICAgICAgICAgICAgICAgIGpRdWVyeSgnW2RhdGEtY29tcG9uZW50PVwic3Bpbm5lclwiXVtkYXRhLW5hbWVzcGFjZT1cImVkaXRvclwiXScpLmFkZENsYXNzKCdoaWRkZW4nKTtcblxuICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICB9LFxuICAgICAgICBtZXRob2RzOiB7XG5cbiAgICAgICAgICAgIGVkaXRQcm9wczogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgY29uc3QgJGZvcm0gPSBQcm9qZWN0LmltcG9ydCgnQGZvcm0tcHJvcHMnKS52dWU7XG4gICAgICAgICAgICAgICAgJGZvcm0uX19lZGl0b3IgPSB0aGlzO1xuICAgICAgICAgICAgICAgIHJldHVybiAkZm9ybS5vcGVuKE9iamVjdC5hc3NpZ24oe1xuICAgICAgICAgICAgICAgICAgICBwYWdlOiAkcGFnZVxuICAgICAgICAgICAgICAgIH0sIGV2ZW50KSk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBpbnNlcnRDb21wb25lbnQ6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGNvbnN0ICRmb3JtID0gUHJvamVjdC5pbXBvcnQoJ0Bmb3JtLWNyZWF0ZUNvbXBvbmVudCcpLnZ1ZTtcbiAgICAgICAgICAgICAgICAkZm9ybS5fX2VkaXRvciA9IHRoaXM7XG4gICAgICAgICAgICAgICAgcmV0dXJuICRmb3JtLm9wZW4oT2JqZWN0LmFzc2lnbih7XG4gICAgICAgICAgICAgICAgICAgIHBhZ2U6ICRwYWdlLFxuICAgICAgICAgICAgICAgIH0sIGV2ZW50KSk7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBfX21ldGFGaWVsZENsYXNzX186IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGNvbnN0ICRldmVudCA9IGV2ZW50IHx8IHt9O1xuICAgICAgICAgICAgICAgIGNvbnN0ICRlZGl0b3IgPSAkZXZlbnQuZWRpdG9yIHx8IHt9O1xuICAgICAgICAgICAgICAgIHJldHVybiBgd3AtbXJsLWZpZWxkIGNvbC0keyRlZGl0b3IuY29sIHx8IDEyfWA7XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBfX3VwZGF0ZU1hcmt1cDogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblxuICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbWFpbiByZXF1ZXN0XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IFJlcXVlc3QgPSBuZXcgV1BBamF4KCdDb21wb3VuZC1nZXRNYXJrdXAnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwYWdlOiAkcGFnZVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBSZXF1ZXN0LnRoZW4oRXZlbnQgPT4ge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgJGJ1ZmZlciA9IFtdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IFtpZCwgdGVtcGxhdGVdIG9mIE9iamVjdC5lbnRyaWVzKEV2ZW50LmRhdGEuZGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkYnVmZmVyLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB0ZW1wbGF0ZS5wcm9wcy5uYW1lIHx8ICdkZWZhdWx0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IGlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZHM6IHRlbXBsYXRlLmZpZWxkcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvcHM6IHRlbXBsYXRlLnByb3BzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubWFya3VwID0gJGJ1ZmZlcjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVzb2x2ZVxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShFdmVudC5kYXRhLmRhdGEpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0pLmNhdGNoKEV2ZW50ID0+IHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVqZWN0XG4gICAgICAgICAgICAgICAgICAgICAgICByZWplY3QoRXZlbnQpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgX19yZW5kZXJEcm9wcGFibGU6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBqUXVlcnkoJ1tkYXRhLWJlaGF2aW9yPVwiZHJvcHBhYmxlXCJdJykuZHJvcHBhYmxlKHtcbiAgICAgICAgICAgICAgICAgICAgYWNjZXB0OiBqUXVlcnkoJ1tkYXRhLWNvbXBvbmVudD1cImZpZWxkXCJdW2RhdGEtbmFtZXNwYWNlPVwiZWRpdG9yXCJdJyksXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZUNsYXNzOiAnd3AtbXJsLXRyYXNoLWFjdGl2ZScsXG4gICAgICAgICAgICAgICAgICAgIGhvdmVyQ2xhc3M6ICd3cC1tcmwtdHJhc2gtaG92ZXInLFxuXG4gICAgICAgICAgICAgICAgICAgIGRyb3A6IGZ1bmN0aW9uIChldmVudCwgdWkpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgJHRlbXBsYXRlID0galF1ZXJ5KHVpLmhlbHBlci5jb250ZXh0KS5hdHRyKCdkYXRhLWlkJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCAkaWQgPSBqUXVlcnkodWkuaGVscGVyLmNvbnRleHQpLmF0dHIoJ2RhdGEtcGFnZS1pZCcpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBSZXF1ZXN0ID0gbmV3IFdQQWpheCgnQ29tcG91bmQtcmVtb3ZlVGVtcGxhdGUnLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQ6ICRpZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZTogJHRlbXBsYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdWkuZHJhZ2dhYmxlLnJlbW92ZSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIF9fcmVuZGVyUGxhY2Vob2xkZXI6IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBldmVudC5wbGFjZWhvbGRlci5oZWlnaHQoZXZlbnQuaXRlbS5oZWlnaHQoKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9LFxuICAgIHJlYWR5OiBmdW5jdGlvbiAoRXZlbnQsICQpIHtcblxuICAgIH1cbn0pKTsiXX0=