"use strict";var t,e;t=void 0,e=function(){function t(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function e(t,e,r){return t[e]===r[0]&&t[e+1]===r[1]&&t[e+2]===r[2]&&t[e+3]===r[3]}function r(t,r,o){for(var n={},i=o.ignoredColor,a=0;a<r;a+=o.step){var s=t[a],u=t[a+1],c=t[a+2],h=t[a+3];if(!i||!e(t,a,i)){var d=Math.round(s/24)+","+Math.round(u/24)+","+Math.round(c/24);n[d]?n[d]=[n[d][0]+s*h,n[d][1]+u*h,n[d][2]+c*h,n[d][3]+h,n[d][4]+1]:n[d]=[s*h,u*h,c*h,h,1]}}var l=Object.keys(n).map((function(t){return n[t]})).sort((function(t,e){var r=t[4],o=e[4];return r>o?-1:r===o?0:1}))[0],f=l[0],g=l[1],v=l[2],p=l[3],_=l[4];return p?[Math.round(f/p),Math.round(g/p),Math.round(v/p),Math.round(p/_)]:o.defaultColor}function o(t,r,o){for(var n=0,i=0,a=0,s=0,u=0,c=o.ignoredColor,h=0;h<r;h+=o.step){var d=t[h+3],l=t[h]*d,f=t[h+1]*d,g=t[h+2]*d;c&&e(t,h,c)||(n+=l,i+=f,a+=g,s+=d,u++)}return s?[Math.round(n/s),Math.round(i/s),Math.round(a/s),Math.round(s/u)]:o.defaultColor}function n(t,r,o){for(var n=0,i=0,a=0,s=0,u=0,c=o.ignoredColor,h=0;h<r;h+=o.step){var d=t[h],l=t[h+1],f=t[h+2],g=t[h+3];c&&e(t,h,c)||(n+=d*d*g,i+=l*l*g,a+=f*f*g,s+=g,u++)}return s?[Math.round(Math.sqrt(n/s)),Math.round(Math.sqrt(i/s)),Math.round(Math.sqrt(a/s)),Math.round(s/u)]:o.defaultColor}var i="FastAverageColor: ";return function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e)}var a,s,u;return a=e,(s=[{key:"getColorAsync",value:function(t,e){if(t){if("string"==typeof t){var r=new Image;return r.src=t,this._bindImageEvents(r,e)}if(t.complete){var o=this.getColor(t,e);return o.error?Promise.reject(o.error):Promise.resolve(o)}return this._bindImageEvents(t,e)}return Promise.reject(Error("".concat(i,"call .getColorAsync() without resource.")))}},{key:"getColor",value:function(t,e){e=e||{};var r=this._getDefaultColor(e),o=r;if(!t)return this._outputError(e,"call .getColor(null) without resource."),this._prepareResult(r);var n=this._getOriginalSize(t),i=this._prepareSizeAndPosition(n,e);if(!(i.srcWidth&&i.srcHeight&&i.destWidth&&i.destHeight))return this._outputError(e,'incorrect sizes for resource "'.concat(t.src,'".')),this._prepareResult(r);if(!this._ctx&&(this._canvas=this._makeCanvas(),this._ctx=this._canvas.getContext&&this._canvas.getContext("2d"),!this._ctx))return this._outputError(e,"Canvas Context 2D is not supported in this browser."),this._prepareResult(r);this._canvas.width=i.destWidth,this._canvas.height=i.destHeight;try{this._ctx.clearRect(0,0,i.destWidth,i.destHeight),this._ctx.drawImage(t,i.srcLeft,i.srcTop,i.srcWidth,i.srcHeight,0,0,i.destWidth,i.destHeight);var a=this._ctx.getImageData(0,0,i.destWidth,i.destHeight).data;o=this.getColorFromArray4(a,e)}catch(r){this._outputError(e,"security error (CORS) for resource ".concat(t.src,".\nDetails: https://developer.mozilla.org/en/docs/Web/HTML/CORS_enabled_image"),r)}return this._prepareResult(o)}},{key:"getColorFromArray4",value:function(t,e){e=e||{};var a=t.length,s=this._getDefaultColor(e);if(a<4)return s;var u,c=a-a%4,h=4*(e.step||1);switch(e.algorithm||"sqrt"){case"simple":u=o;break;case"sqrt":u=n;break;case"dominant":u=r;break;default:throw Error("".concat(i).concat(e.algorithm," is unknown algorithm."))}return u(t,c,{defaultColor:s,ignoredColor:e.ignoredColor,step:h})}},{key:"destroy",value:function(){delete this._canvas,delete this._ctx}},{key:"_getDefaultColor",value:function(t){return this._getOption(t,"defaultColor",[0,0,0,0])}},{key:"_getOption",value:function(t,e,r){return void 0===t[e]?r:t[e]}},{key:"_prepareSizeAndPosition",value:function(t,e){var r,o=this._getOption(e,"left",0),n=this._getOption(e,"top",0),i=this._getOption(e,"width",t.width),a=this._getOption(e,"height",t.height),s=i,u=a;return"precision"===e.mode||(i>a?(r=i/a,s=100,u=Math.round(s/r)):(r=a/i,u=100,s=Math.round(u/r)),(s>i||u>a||s<10||u<10)&&(s=i,u=a)),{srcLeft:o,srcTop:n,srcWidth:i,srcHeight:a,destWidth:s,destHeight:u}}},{key:"_bindImageEvents",value:function(t,e){var r=this;return new Promise((function(o,n){var a=function(){c();var i=r.getColor(t,e);i.error?n(i.error):o(i)},s=function(){c(),n(Error("".concat(i,"Error loading image ").concat(t.src,".")))},u=function(){c(),n(Error("".concat(i,'Image "').concat(t.src,'" loading aborted.')))},c=function(){t.removeEventListener("load",a),t.removeEventListener("error",s),t.removeEventListener("abort",u)};t.addEventListener("load",a),t.addEventListener("error",s),t.addEventListener("abort",u)}))}},{key:"_prepareResult",value:function(t){var e=t.slice(0,3),r=[].concat(e,t[3]/255),o=this._isDark(t);return{value:t,rgb:"rgb("+e.join(",")+")",rgba:"rgba("+r.join(",")+")",hex:this._arrayToHex(e),hexa:this._arrayToHex(t),isDark:o,isLight:!o}}},{key:"_getOriginalSize",value:function(t){return t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:{width:t.width,height:t.height}}},{key:"_toHex",value:function(t){var e=t.toString(16);return 1===e.length?"0"+e:e}},{key:"_arrayToHex",value:function(t){return"#"+t.map(this._toHex).join("")}},{key:"_isDark",value:function(t){return(299*t[0]+587*t[1]+114*t[2])/1e3<128}},{key:"_makeCanvas",value:function(){return"undefined"==typeof window?new OffscreenCanvas(1,1):document.createElement("canvas")}},{key:"_outputError",value:function(t,e,r){t.silent||(console.error("".concat(i).concat(e)),r&&console.error(r))}}])&&t(a.prototype,s),u&&t(a,u),e}()},"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).FastAverageColor=e();
//# sourceMappingURL=color_recognition-dist.js.map